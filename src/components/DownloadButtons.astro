---
---

<!-- Load html-to-image from CDN -->
<script src="https://cdn.jsdelivr.net/npm/html-to-image@1.11.11/dist/html-to-image.min.js"></script>

<button
  class="px-6 py-3 bg-rs-primary-500 text-white rounded-lg hover:bg-rs-primary-600 transition font-semibold shadow-lg"
  id="download-btn"
  type="button"
>
  📥 Download as Image
</button>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('download-btn')?.addEventListener('click', async () => {
      const button = document.getElementById('download-btn');
      const node = document.getElementById('signature-card');
      
      if (!node || !window.htmlToImage) {
        alert('Error: Unable to capture signature. Please try again.');
        return;
      }

      // Show loading state
      button.textContent = '⏳ Generating...';
      button.disabled = true;

      try {
        // Generate the image with better quality
        const dataUrl = await window.htmlToImage.toPng(node, {
          quality: 1.0,
          pixelRatio: 2, // Higher resolution
          backgroundColor: '#ffffff',
          style: {
            transform: 'scale(1)',
            transformOrigin: 'top left'
          }
        });

        // Create download link
        const link = document.createElement('a');
        link.download = 'romega-signature.png';
        link.href = dataUrl;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        // Show success message
        button.textContent = '✅ Downloaded!';
        setTimeout(() => {
          button.textContent = '📥 Download as Image';
          button.disabled = false;
        }, 2000);

      } catch (error) {
        console.error('Download failed:', error);
        alert('Download failed. Please try again.');
        button.textContent = '📥 Download as Image';
        button.disabled = false;
      }
    });
  });
</script>