---
import ControlsForm from './ControlsForm.astro';
import SignaturePreview from './SignaturePreview.astro';
import DownloadButtons from './DownloadButtons.astro';


const defaultData = {
  name: "MARY JERELY LAGUDA",
  title: "WEB DEVELOPER", 
  phone: "+63 919 097 8700",
  email: "jem@romega-solutions.com"
};
---

<div class="min-h-screen bg-rs-neutral-100 py-12">
  <div class="max-w-4xl mx-auto px-4">
    <!-- Header Section -->
    <div class="text-center mb-12">
      <h1 class="signature-name text-4xl text-rs-primary-700 mb-4">
        Email Signature Creator
      </h1>
      <p class="signature-contact text-lg text-rs-neutral-600 max-w-2xl mx-auto">
        Create professional email signatures with live preview. Fill out the form below and watch your signature update in real-time.
      </p>
    </div>

    <!-- Signature Preview Section -->
    <div class="mb-12">
      <div class="bg-white rounded-2xl shadow-xl p-8 border border-rs-neutral-200">
        <h2 class="signature-title text-xl text-rs-primary-600 mb-6 text-center">
          Live Preview
        </h2>
        <div class="flex justify-center">
          <SignaturePreview formData={defaultData} />
        </div>
        <div class="flex justify-center mt-8">
          <DownloadButtons />
        </div>
      </div>
    </div>

    <!-- Form Section -->
    <div class="bg-white rounded-2xl shadow-xl p-8 border border-rs-neutral-200">
      <h2 class="signature-title text-xl text-rs-primary-600 mb-6 text-center">
        Edit Your Information
      </h2>
      <div class="max-w-2xl mx-auto">
        <ControlsForm formData={defaultData} />
      </div>
    </div>

    <!-- Instructions Section -->
    <div class="mt-12 bg-rs-primary-50 rounded-2xl p-8 border border-rs-primary-200">
      <h3 class="signature-title text-lg text-rs-primary-700 mb-4 text-center">
        How to Use
      </h3>
      <div class="grid md:grid-cols-3 gap-6 text-center">
        <div class="flex flex-col items-center">
          <div class="w-12 h-12 bg-rs-primary-500 text-white rounded-full flex items-center justify-center font-bold text-lg mb-3">
            1
          </div>
          <h4 class="signature-contact font-semibold text-rs-primary-700 mb-2">Fill the Form</h4>
          <p class="signature-contact text-sm text-rs-neutral-600">Enter your personal and company information in the form below</p>
        </div>
        <div class="flex flex-col items-center">
          <div class="w-12 h-12 bg-rs-accent-500 text-white rounded-full flex items-center justify-center font-bold text-lg mb-3">
            2
          </div>
          <h4 class="signature-contact font-semibold text-rs-primary-700 mb-2">Watch Preview</h4>
          <p class="signature-contact text-sm text-rs-neutral-600">See your signature update live as you type</p>
        </div>
        <div class="flex flex-col items-center">
          <div class="w-12 h-12 bg-rs-primary-600 text-white rounded-full flex items-center justify-center font-bold text-lg mb-3">
            3
          </div>
          <h4 class="signature-contact font-semibold text-rs-primary-700 mb-2">Download</h4>
          <p class="signature-contact text-sm text-rs-neutral-600">Click download to save your signature as an image</p>
        </div>
      </div>
    </div>
  </div>
</div>


<script type="module">
  // Simple state sync between form and preview
  const form = document.querySelector('form');
  const fields = ["name", "title", "phone", "email"]; // Removed logoUrl, website, address

  if (form) {
    form.addEventListener('input', (e) => {
      const fieldName = e.target.name;
      const fieldValue = e.target.value;
      
      if (fields.includes(fieldName)) {
        const target = document.querySelector(`[data-field="${fieldName}"]`);
        
        if (target) {
          target.textContent = fieldValue;
        }
      }
    });
  }
</script>